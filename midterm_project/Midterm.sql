-- Because NA cannot be recognised by sql, I change all the NA into Null. 
alter table [hge].[DIQ] 
alter column [_DID040_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ160_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ170_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ172_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175A_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175B_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175C_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175D_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175E_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175F_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175G_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175H_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175I_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175J_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175K_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175L_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175M_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175N_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175O_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175P_] NVARCHAR(50) NULL
alter table [hge].[DIQ]
alter column [_DIQ175Q_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175R_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175S_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175T_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175U_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175V_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175W_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ175X_] NVARCHAR(50) NULL
alter column [_DIQ180_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ050_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID060_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ060U_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ070_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ230_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ240_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID250_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID260_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ260U_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ275_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ280_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ291_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ300S_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ300D_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID310S_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID310D_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID320_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID330_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID341_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DID350_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ350U_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ360_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 
alter column [_DIQ080_] NVARCHAR(50) NULL
alter table [hge].[DIQ] 



update [hge].[DIQ] set [_DID040_] = NULL
where [_DID040_] = 'NA'
update [hge].[DIQ] set [_DIQ160_] = NULL
where [_DIQ160_] = 'NA'
update [hge].[DIQ] set [_DIQ170_] = NULL
where [_DIQ170_] = 'NA'
update [hge].[DIQ] set [_DIQ172_] = NULL
where [_DIQ172_] = 'NA'
update [hge].[DIQ] set [_DIQ175A_] = NULL
where [_DIQ175A_] = 'NA'
update [hge].[DIQ] set [_DIQ175B_] = NULL
where [_DIQ175B_] = 'NA'

update [hge].[DIQ] set [_DIQ175C_] = NULL
where [_DIQ175C_] = 'NA'

update [hge].[DIQ] set [_DIQ175D_] = NULL
where [_DIQ175D_] = 'NA'

update [hge].[DIQ] set [_DIQ175E_] = NULL
where [_DIQ175E_] = 'NA'

update [hge].[DIQ] set [_DIQ175F_] = NULL
where [_DIQ175F_] = 'NA'

update [hge].[DIQ] set [_DIQ175G_] = NULL
where [_DIQ175G_] = 'NA'

update [hge].[DIQ] set [_DIQ175H_] = NULL
where [_DIQ175H_] = 'NA'

update [hge].[DIQ] set [_DIQ175I_] = NULL
where [_DIQ175I_] = 'NA'

update [hge].[DIQ] set [_DIQ175J_] = NULL
where [_DIQ175J_] = 'NA'

update [hge].[DIQ] set [_DIQ175K_] = NULL
where [_DIQ175K_] = 'NA'

update [hge].[DIQ] set [_DIQ175L_] = NULL
where [_DIQ175L_] = 'NA'

update [hge].[DIQ] set [_DIQ175M_] = NULL
where [_DIQ175M_] = 'NA'

update [hge].[DIQ] set [_DIQ175N_] = NULL
where [_DIQ175N_] = 'NA'

update [hge].[DIQ] set [_DIQ175O_] = NULL
where [_DIQ175O_] = 'NA'

update [hge].[DIQ] set [_DIQ175P_] = NULL
where [_DIQ175P_] = 'NA'

update [hge].[DIQ] set [_DIQ175Q_] = NULL
where [_DIQ175Q_] = 'NA'

update [hge].[DIQ] set [_DIQ175R_] = NULL
where [_DIQ175R_] = 'NA'

update [hge].[DIQ] set [_DIQ175S_] = NULL
where [_DIQ175S_] = 'NA'

update [hge].[DIQ] set [_DIQ175T_] = NULL
where [_DIQ175T_] = 'NA'

update [hge].[DIQ] set [_DIQ175U_] = NULL
where [_DIQ175U_] = 'NA'

update [hge].[DIQ] set [_DIQ175V_] = NULL
where [_DIQ175V_] = 'NA'

update [hge].[DIQ] set [_DIQ175W_] = NULL
where [_DIQ175W_] = 'NA'

update [hge].[DIQ] set [_DIQ175X_] = NULL
where [_DIQ175X_] = 'NA'

update [hge].[DIQ] set [_DIQ180_] = NULL
where [_DIQ180_] = 'NA'

update [hge].[DIQ] set [_DIQ050_] = NULL
where [_DIQ050_] = 'NA'

update [hge].[DIQ] set [_DID060_] = NULL
where [_DID060_] = 'NA'

update [hge].[DIQ] set [_DIQ060U_] = NULL
where [_DIQ060U_] = 'NA'

update [hge].[DIQ] set [_DIQ070_] = NULL
where [_DIQ070_] = 'NA'

update [hge].[DIQ] set [_DIQ230_] = NULL
where [_DIQ230_] = 'NA'

update [hge].[DIQ] set [_DIQ240_] = NULL
where [_DIQ240_] = 'NA'

update [hge].[DIQ] set [_DID250_] = NULL
where [_DID250_] = 'NA'

update [hge].[DIQ] set [_DID260_] = NULL
where [_DID260_] = 'NA'

update [hge].[DIQ] set [_DIQ260U_] = NULL
where [_DIQ260U_] = 'NA'

update [hge].[DIQ] set [_DIQ275_] = NULL
where [_DIQ275_] = 'NA'

update [hge].[DIQ] set [_DIQ280_] = NULL
where [_DIQ280_] = 'NA'

update [hge].[DIQ] set [_DIQ291_] = NULL
where [_DIQ291_] = 'NA'

update [hge].[DIQ] set [_DIQ300S_] = NULL
where [_DIQ300S_] = 'NA'

update [hge].[DIQ] set [_DIQ300D_] = NULL
where [_DIQ300D_] = 'NA'

update [hge].[DIQ] set [_DID310S_] = NULL
where [_DID310S_] = 'NA'

update [hge].[DIQ] set [_DID310D_] = NULL
where [_DID310D_] = 'NA'

update [hge].[DIQ] set [_DID320_] = NULL
where [_DID320_] = 'NA'

update [hge].[DIQ] set [_DID330_] = NULL
where [_DID330_] = 'NA'

update [hge].[DIQ] set [_DID341_] = NULL
where [_DID341_] = 'NA'

update [hge].[DIQ] set [_DID350_] = NULL
where [_DID350_] = 'NA'

update [hge].[DIQ] set [_DIQ350U_] = NULL
where [_DIQ350U_] = 'NA'

update [hge].[DIQ] set [_DIQ360_] = NULL
where [_DIQ360_] = 'NA'

update [hge].[DIQ] set [_DIQ080_] = NULL
where [_DIQ080_] = 'NA'

select top 10* from hge.DIQ


--Verify the variables using count

--[_DIQ010_]

select COUNT([_DIQ010_]) from [hge].[DIQ]
where [_DIQ010_] = '1'

select COUNT([_DIQ010_]) from [hge].[DIQ]
where [_DIQ010_] = '2'

select COUNT([_DIQ010_]) from [hge].[DIQ]
where [_DIQ010_] = '3'

select COUNT([_DIQ010_]) from [hge].[DIQ]
where [_DIQ010_] = '7'

select COUNT([_DIQ010_]) from [hge].[DIQ]
where [_DIQ010_] = '9'

select COUNT(*)-COUNT([_DIQ010_]) from [hge].[DIQ]



--[_DIQ040_]
select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] between '2' and '78'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '80'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '666'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '777'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '999'

select COUNT(*)-COUNT([_DID040_]) from [hge].[DIQ]

--[_DIQ160_]

select COUNT([_DIQ160_]) from [hge].[DIQ]
where [_DIQ160_] = '1'

select COUNT([_DIQ160_]) from [hge].[DIQ]
where [_DIQ160_] = '2'

select COUNT([_DIQ160_]) from [hge].[DIQ]
where [_DIQ160_] = '7'

select COUNT([_DIQ160_]) from [hge].[DIQ]
where [_DIQ160_] = '9'

select COUNT(*)-COUNT([_DIQ160_]) from [hge].[DIQ]

--[_DIQ170_]

select COUNT([_DIQ170_]) from [hge].[DIQ]
where [_DIQ170_] = '1'

select COUNT([_DIQ170_]) from [hge].[DIQ]
where [_DIQ170_] = '2'

select COUNT([_DIQ170_]) from [hge].[DIQ]
where [_DIQ170_] = '7'

select COUNT([_DIQ170_]) from [hge].[DIQ]
where [_DIQ170_] = '9'

select COUNT(*)-COUNT([_DIQ170_]) from [hge].[DIQ]

--[_DIQ172_]

select COUNT([_DIQ172_]) from [hge].[DIQ]
where [_DIQ172_] = '1'

select COUNT([_DIQ172_]) from [hge].[DIQ]
where [_DIQ172_] = '2'

select COUNT([_DIQ172_]) from [hge].[DIQ]
where [_DIQ172_] = '7'

select COUNT([_DIQ172_]) from [hge].[DIQ]
where [_DIQ172_] = '9'

select COUNT(*)-COUNT([_DIQ172_]) from [hge].[DIQ]


--[_DIQ175A_] 
select COUNT([_DIQ175A_]) from [hge].[DIQ]
where [_DIQ175A_] = '10'

select COUNT([_DIQ175A_]) from [hge].[DIQ]
where [_DIQ175A_] = '77'

select COUNT([_DIQ175A_]) from [hge].[DIQ]
where [_DIQ175A_] = '99'

select COUNT(*)-COUNT([_DIQ175A_]) from [hge].[DIQ]


--[_DIQ175B_]
select COUNT([_DIQ175B_]) from [hge].[DIQ]
where [_DIQ175B_] = '11'
select COUNT(*)-COUNT([_DIQ175B_]) from [hge].[DIQ]

--[_DIQ175C_]
select COUNT([_DIQ175C_]) from [hge].[DIQ]
where [_DIQ175C_] = '12'
select COUNT(*)-COUNT([_DIQ175C_]) from [hge].[DIQ]

--[_DIQ175D_]
select COUNT([_DIQ175D_]) from [hge].[DIQ]
where [_DIQ175D_] = '13'
select COUNT(*)-COUNT([_DIQ175D_]) from [hge].[DIQ]

--[_DIQ175E_]
select COUNT([_DIQ175E_]) from [hge].[DIQ]
where [_DIQ175E_] = '14'
select COUNT(*)-COUNT([_DIQ175E_]) from [hge].[DIQ]

--[_DIQ175F_]
select COUNT([_DIQ175F_]) from [hge].[DIQ]
where [_DIQ175F_] = '15'
select COUNT(*)-COUNT([_DIQ175F_]) from [hge].[DIQ]

--[_DIQ175G_]
select COUNT([_DIQ175G_]) from [hge].[DIQ]
where [_DIQ175G_] = '16'
select COUNT(*)-COUNT([_DIQ175G_]) from [hge].[DIQ]

--[_DIQ175H_]
select COUNT([_DIQ175H_]) from [hge].[DIQ]
where [_DIQ175H_] = '17'
select COUNT(*)-COUNT([_DIQ175H_]) from [hge].[DIQ]

--[_DIQ175I_]
select COUNT([_DIQ175I_]) from [hge].[DIQ]
where [_DIQ175I_] = '18'
select COUNT(*)-COUNT([_DIQ175I_]) from [hge].[DIQ]

--[_DIQ175J_]
select COUNT([_DIQ175J_]) from [hge].[DIQ]
where [_DIQ175J_] = '19'
select COUNT(*)-COUNT([_DIQ175J_]) from [hge].[DIQ]

--[_DIQ175K_]
select COUNT([_DIQ175K_]) from [hge].[DIQ]
where [_DIQ175K_] = '20'
select COUNT(*)-COUNT([_DIQ175K_]) from [hge].[DIQ]

--[_DIQ175L_]
select COUNT([_DIQ175L_]) from [hge].[DIQ]
where [_DIQ175L_] = '21'
select COUNT(*)-COUNT([_DIQ175L_]) from [hge].[DIQ]

--[_DIQ175M_]
select COUNT([_DIQ175M_]) from [hge].[DIQ]
where [_DIQ175M_] = '22'
select COUNT(*)-COUNT([_DIQ175M_]) from [hge].[DIQ]

--[_DIQ175N_]
select COUNT([_DIQ175N_]) from [hge].[DIQ]
where [_DIQ175N_] = '23'
select COUNT(*)-COUNT([_DIQ175N_]) from [hge].[DIQ]

--[_DIQ175O_]
select COUNT([_DIQ175O_]) from [hge].[DIQ]
where [_DIQ175O_] = '24'
select COUNT(*)-COUNT([_DIQ175O_]) from [hge].[DIQ]

--[_DIQ175P_]
select COUNT([_DIQ175P_]) from [hge].[DIQ]
where [_DIQ175P_] = '25'
select COUNT(*)-COUNT([_DIQ175P_]) from [hge].[DIQ]

--[_DIQ175Q_]
select COUNT([_DIQ175Q_]) from [hge].[DIQ]
where [_DIQ175Q_] = '26'
select COUNT(*)-COUNT([_DIQ175Q_]) from [hge].[DIQ]

--[_DIQ175R_]
select COUNT([_DIQ175R_]) from [hge].[DIQ]
where [_DIQ175R_] = '27'
select COUNT(*)-COUNT([_DIQ175R_]) from [hge].[DIQ]

--[_DIQ175S_]
select COUNT([_DIQ175S_]) from [hge].[DIQ]
where [_DIQ175S_] = '28'
select COUNT(*)-COUNT([_DIQ175S_]) from [hge].[DIQ]

--[_DIQ175T_]
select COUNT([_DIQ175T_]) from [hge].[DIQ]
where [_DIQ175T_] = '29'
select COUNT(*)-COUNT([_DIQ175T_]) from [hge].[DIQ]

--[_DIQ175U_]
select COUNT([_DIQ175U_]) from [hge].[DIQ]
where [_DIQ175U_] = '30'
select COUNT(*)-COUNT([_DIQ175U_]) from [hge].[DIQ]

--[_DIQ175V_]
select COUNT([_DIQ175V_]) from [hge].[DIQ]
where [_DIQ175V_] = '31'
select COUNT(*)-COUNT([_DIQ175V_]) from [hge].[DIQ]


--[_DIQ175W_]
select COUNT([_DIQ175W_]) from [hge].[DIQ]
where [_DIQ175W_] = '32'
select COUNT(*)-COUNT([_DIQ175W_]) from [hge].[DIQ]

--[_DIQ175X_]
select COUNT([_DIQ175X_]) from [hge].[DIQ]
where [_DIQ175X_] = '33'
select COUNT(*)-COUNT([_DIQ175X_]) from [hge].[DIQ]

--[_DIQ180_]

select COUNT([_DIQ180_]) from [hge].[DIQ]
where [_DIQ180_] = '1'

select COUNT([_DIQ180_]) from [hge].[DIQ]
where [_DIQ180_] = '2'

select COUNT([_DIQ180_]) from [hge].[DIQ]
where [_DIQ180_] = '7'

select COUNT([_DIQ180_]) from [hge].[DIQ]
where [_DIQ180_] = '9'

select COUNT(*)-COUNT([_DIQ180_]) from [hge].[DIQ]

--[_DIQ050_]

select COUNT([_DIQ050_]) from [hge].[DIQ]
where [_DIQ050_] = '1'

select COUNT([_DIQ050_]) from [hge].[DIQ]
where [_DIQ050_] = '2'

select COUNT([_DIQ050_]) from [hge].[DIQ]
where [_DIQ050_] = '7'

select COUNT([_DIQ050_]) from [hge].[DIQ]
where [_DIQ050_] = '9'

select COUNT(*)-COUNT([_DIQ050_]) from [hge].[DIQ]


--[_DID060_]

select COUNT([_DID060_]) from [hge].[DIQ]
where [_DID060_] between '1' and '55'

select COUNT([_DID060_]) from [hge].[DIQ]
where [_DID060_] = '666'

select COUNT([_DID060_]) from [hge].[DIQ]
where [_DID060_] = '777'

select COUNT([_DID060_]) from [hge].[DIQ]
where [_DID060_] = '999'

select COUNT(*)-COUNT([_DID060_]) from [hge].[DIQ]

--[_DIQ060U_]

select COUNT([_DIQ060U_]) from [hge].[DIQ]
where [_DIQ060U_] = '1'

select COUNT([_DIQ060U_]) from [hge].[DIQ]
where [_DIQ060U_] = '2'

select COUNT(*)-COUNT([_DIQ060U_]) from [hge].[DIQ]


--[_DIQ070_]
select COUNT([_DIQ070_]) from [hge].[DIQ]
where [_DIQ070_] = '1'

select COUNT([_DIQ070_]) from [hge].[DIQ]
where [_DIQ070_] = '2'

select COUNT([_DIQ070_]) from [hge].[DIQ]
where [_DIQ070_] = '7'

select COUNT([_DIQ070_]) from [hge].[DIQ]
where [_DIQ070_] = '9'

select COUNT(*)-COUNT([_DIQ070_]) from [hge].[DIQ]

--[_DIQ230_]
select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '1'

select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '2'

select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '3'

select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '4'

select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '5'

select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '7'

select COUNT([_DIQ230_]) from [hge].[DIQ]
where [_DIQ230_] = '9'

select COUNT(*)-COUNT([_DIQ230_]) from [hge].[DIQ]

--[_DIQ240_]
select COUNT([_DIQ240_]) from [hge].[DIQ]
where [_DIQ240_] = '1'

select COUNT([_DIQ240_]) from [hge].[DIQ]
where [_DIQ240_] = '2'

select COUNT([_DIQ240_]) from [hge].[DIQ]
where [_DIQ240_] = '7'

select COUNT([_DIQ240_]) from [hge].[DIQ]
where [_DIQ240_] = '9'

select COUNT(*)-COUNT([_DIQ240_]) from [hge].[DIQ]

--[_DID250_]
select COUNT([_DID250_]) from [hge].[DIQ]
where [_DID250_] between '1' and '60'

select COUNT([_DID250_]) from [hge].[DIQ]
where [_DID250_] = '0'

select COUNT([_DID250_]) from [hge].[DIQ]
where [_DID250_] = '7777'

select COUNT([_DID250_]) from [hge].[DIQ]
where [_DID250_] = '9999'

select COUNT(*)-COUNT([_DID250_]) from [hge].[DIQ]

--[_DID260_]
select COUNT([_DID260_]) from [hge].[DIQ]
where [_DID260_] between '1' and '15'

select COUNT([_DID260_]) from [hge].[DIQ]
where [_DID260_] = '0'

select COUNT([_DID260_]) from [hge].[DIQ]
where [_DID260_] = '777'

select COUNT([_DID260_]) from [hge].[DIQ]
where [_DID260_] = '999'

select COUNT(*)-COUNT([_DID260_]) from [hge].[DIQ]

--[_DIQ260U_]
select COUNT([_DIQ260U_]) from [hge].[DIQ]
where [_DIQ260U_] = '1'

select COUNT([_DIQ260U_]) from [hge].[DIQ]
where [_DIQ260U_] = '2'

select COUNT([_DIQ260U_]) from [hge].[DIQ]
where [_DIQ260U_] = '3'

select COUNT([_DIQ260U_]) from [hge].[DIQ]
where [_DIQ260U_] = '4'

select COUNT(*)-COUNT([_DIQ260U_]) from [hge].[DIQ]

--[_DIQ275_]
select COUNT([_DIQ275_]) from [hge].[DIQ]
where [_DIQ275_] = '1'

select COUNT([_DIQ275_]) from [hge].[DIQ]
where [_DIQ275_] = '2'

select COUNT([_DIQ275_]) from [hge].[DIQ]
where [_DIQ275_] = '7'

select COUNT([_DIQ275_]) from [hge].[DIQ]
where [_DIQ275_] = '9'

select COUNT(*)-COUNT([_DIQ275_]) from [hge].[DIQ]

--[_DIQ280_]
select COUNT([_DIQ280_]) from [hge].[DIQ]
where [_DIQ280_] between '2' and '18.5'


select COUNT([_DIQ280_]) from [hge].[DIQ]
where [_DIQ280_] = '777'

select COUNT([_DIQ280_]) from [hge].[DIQ]
where [_DIQ280_] = '999'

select COUNT(*)-COUNT([_DIQ280_]) from [hge].[DIQ]


--[_DIQ291_]
select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '1'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '2'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '3'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '4'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '5'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '6'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '77'

select COUNT([_DIQ291_]) from [hge].[DIQ]
where [_DIQ291_] = '99'

select COUNT(*)-COUNT([_DIQ291_]) from [hge].[DIQ]

--[_DIQ300S_]
select COUNT([_DIQ300S_]) from [hge].[DIQ]
where [_DIQ300S_] between '80' and '201'

select COUNT([_DIQ300S_]) from [hge].[DIQ]
where [_DIQ300S_] = '7777'

select COUNT([_DIQ300S_]) from [hge].[DIQ]
where [_DIQ300S_] = '9999'

select COUNT(*)-COUNT([_DIQ300S_]) from [hge].[DIQ]

--[_DIQ300D_]
select COUNT([_DIQ300D_]) from [hge].[DIQ]
where [_DIQ300D_] between '17' and '251'

select COUNT([_DIQ300D_]) from [hge].[DIQ]
where [_DIQ300D_] = '7777'

select COUNT([_DIQ300D_]) from [hge].[DIQ]
where [_DIQ300D_] = '9999'

select COUNT(*)-COUNT([_DIQ300D_]) from [hge].[DIQ]

--[_DID310S_]
select COUNT([_DID310S_]) from [hge].[DIQ]
where [_DID310S_] between '80' and '175'

select COUNT([_DID310S_]) from [hge].[DIQ]
where [_DID310S_] = '6666'

select COUNT([_DID310S_]) from [hge].[DIQ]
where [_DID310S_] = '7777'

select COUNT([_DID310S_]) from [hge].[DIQ]
where [_DID310S_] = '9999'

select COUNT(*)-COUNT([_DID310S_]) from [hge].[DIQ]

--[_DID310D_]
select COUNT([_DID310D_]) from [hge].[DIQ]
where [_DID310D_] between '18' and '140'

select COUNT([_DID310D_]) from [hge].[DIQ]
where [_DID310D_] = '6666'

select COUNT([_DID310D_]) from [hge].[DIQ]
where [_DID310D_] = '7777'

select COUNT([_DID310D_]) from [hge].[DIQ]
where [_DID310D_] = '9999'

select COUNT(*)-COUNT([_DID310D_]) from [hge].[DIQ]

--[_DID320_]

select COUNT([_DID320_]) from [hge].[DIQ]
where [_DID320_] between '4' and '520'

select COUNT([_DID320_]) from [hge].[DIQ]
where [_DID320_] = '5555'


select COUNT([_DID320_]) from [hge].[DIQ]
where [_DID320_] = '6666'

select COUNT([_DID320_]) from [hge].[DIQ]
where [_DID320_] = '7777'

select COUNT([_DID320_]) from [hge].[DIQ]
where [_DID320_] = '9999'

select COUNT(*)-COUNT([_DID320_]) from [hge].[DIQ]

--[_DID330_]
select COUNT([_DID330_]) from [hge].[DIQ]
where [_DID330_] between '6' and '205'

select COUNT([_DID330_]) from [hge].[DIQ]
where [_DID330_] = '6666'

select COUNT([_DID330_]) from [hge].[DIQ]
where [_DID330_] = '7777'

select COUNT([_DID330_]) from [hge].[DIQ]
where [_DID330_] = '9999'

select COUNT(*)-COUNT([_DID330_]) from [hge].[DIQ]

--[_DID341_]

select COUNT([_DID341_]) from [hge].[DIQ]
where [_DID341_] between '1' and '34'

select COUNT([_DID341_]) from [hge].[DIQ]
where [_DID341_] = '0'

select COUNT([_DID341_]) from [hge].[DIQ]
where [_DID341_] = '7777'

select COUNT([_DID341_]) from [hge].[DIQ]
where [_DID341_] = '9999'

select COUNT(*)-COUNT([_DID341_]) from [hge].[DIQ]

--[_DID350_]

select COUNT([_DID350_]) from [hge].[DIQ]
where [_DID350_] between '1' and '20'

select COUNT([_DID350_]) from [hge].[DIQ]
where [_DID350_] = '0'

select COUNT([_DID350_]) from [hge].[DIQ]
where [_DID350_] = '7777'

select COUNT([_DID350_]) from [hge].[DIQ]
where [_DID350_] = '9999'

select COUNT(*)-COUNT([_DID350_]) from [hge].[DIQ]

--[_DIQ350U_]

select COUNT([_DIQ350U_]) from [hge].[DIQ]
where [_DIQ350U_] = '1'

select COUNT([_DIQ350U_]) from [hge].[DIQ]
where [_DIQ350U_] = '2'

select COUNT([_DIQ350U_]) from [hge].[DIQ]
where [_DIQ350U_] = '3'

select COUNT([_DIQ350U_]) from [hge].[DIQ]
where [_DIQ350U_] = '4'

select COUNT(*)-COUNT([_DIQ350U_]) from [hge].[DIQ]


--[_DIQ360_]

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '1'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '2'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '3'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '4'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '5'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '6'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '7'

select COUNT([_DIQ360_]) from [hge].[DIQ]
where [_DIQ360_] = '9'

select COUNT(*)-COUNT([_DIQ360_]) from [hge].[DIQ]

--[_DIQ080_]
select COUNT([_DIQ080_]) from [hge].[DIQ]
where [_DIQ080_] = '1'

select COUNT([_DIQ080_]) from [hge].[DIQ]
where [_DIQ080_] = '2'

select COUNT([_DIQ080_]) from [hge].[DIQ]
where [_DIQ080_] = '7'

select COUNT([_DIQ080_]) from [hge].[DIQ]
where [_DIQ080_] = '9'

select COUNT(*)-COUNT([_DIQ080_]) from [hge].[DIQ]




--DID040
--666 represents the time less than 1 year, so I use mean 0.5 to replace all the 666 value so that I can 
--calculate the mean of whole value. 



select * into hge.math from [hge].[DIQ]
alter table [hge].[math] alter column [_DID040_] float


update [hge].[math] set [_DID040_] = 0.5
where [_DID040_] = '666'


select AVG ([_DID040_]) from [hge].[math] 
where  [_DID040_] ! = 999

-- Now I get the mean of DID040 and I use the mean to replace 999, which means participants don't know. Because those 
-- participants don't know about their situation, it is reasonable to use mean value to predict their situation. 
--Moreover, using this way will not make any difference on the mean of whole value of DID040. 

update [hge].[DIQ] set [_DID040_] = 48.4
where [_DID040_] = '999' 

select [_DID040_] from [hge].[DIQ]


--DIQ160
select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '1'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '2'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '7'

select COUNT([_DID040_]) from [hge].[DIQ]
where [_DID040_] = '9'

select COUNT(*)-COUNT([_DID040_]) from [hge].[DIQ]











--DIQ060U
-- Because the unit of measure are different, I need to change different unit into uniform unit sothat I can calculate
-- mean of value later. 

alter table [hge].[DIQ] alter column [_DIQ060U_] float
alter table [hge].[DIQ] alter column [_DID060_] float

update [hge].[DIQ] set [_DIQ060U_] = 12
where [_DID040_] = 2

update [hge].[DIQ] set [_DID060_] = 0.5
where [_DID060_] = '666'

update [hge].[DIQ] set [_DID060_] = [_DIQ060U_]*[_DID060_]



--DID060
-- use same method in DID040 to clean DID060 

select AVG ([_DID060_]) from [hge].[DIQ] 
where  [_DID060_] ! = 999

update [hge].[DIQ] set [_DID040_] = 102.3
where [_DID040_] = '999'



--DID250
alter table [hge].[math] alter column [_DID250_] float

select AVG ([_DID250_]) from [hge].[math] 
where  [_DID250_] ! = 9999

update [hge].[DIQ] set [_DID250_] = 4.5
where [_DID250_] = '9999'



-- DIQ260U
alter table [hge].[DIQ] alter column [_DIQ260U_] float
alter table [hge].[DIQ] alter column [_DID260_] float

update [hge].[DIQ] set [_DIQ260U_] = 365
where [_DIQ260U_] = 1

update [hge].[DIQ] set [_DIQ260U_] = 52.1
where [_DIQ260U_] = 2

update [hge].[DIQ] set [_DIQ260U_] = 12
where [_DIQ260U_] = 3

update [hge].[DIQ] set [_DIQ260U_] = 1
where [_DIQ260U_] = 4


update [hge].[DIQ] set [_DID260_] = [_DIQ260U_]*[_DID260_]




--DIQ280
alter table [hge].[math] alter column [_DIQ280_] float

select AVG ([_DIQ280_]) from [hge].[DIQ] 
where  [_DIQ280_] ! = 999 and [_DIQ280_] ! = 777

update [hge].[DIQ] set [_DIQ280_] = 7.33
where [_DIQ280_] = '999'

-- 777 means people who refused to answer the question. Thus, they can be regarded as people who 
-- do not participate the question. So, I assign Null to those who refused answering question. 

update [hge].[DIQ] set [_DIQ280_] = NULL
where [_DIQ280_] = '777'



--DIQ300S
alter table [hge].[math] alter column [_DIQ300S_] float

select AVG ([_DIQ300S_]) from [hge].[math] 
where  [_DIQ300S_] ! = 9999 and [_DIQ300S_] ! = 7777

update [hge].[DIQ] set [_DIQ300S_] = 130.5
where [_DIQ300S_] = '9999'

update [hge].[DIQ] set [_DIQ300S_] = NULL
where [_DIQ300S_] = '7777'



--DIQ300D
alter table [hge].[math] alter column [_DIQ300D_] float

select AVG ([_DIQ300D_]) from [hge].[math] 
where  [_DIQ300D_] ! = 9999 and [_DIQ300D_] ! = 7777

update [hge].[DIQ] set [_DIQ300D_] = 78.23
where [_DIQ300D_] = '9999'

update [hge].[DIQ] set [_DIQ300D_] = NULL
where [_DIQ300D_] = '7777'



--DID310S
alter table [hge].[math] alter column [_DID310S_] float

select AVG ([_DID310S_]) from [hge].[math] 
where  [_DID310S_] ! = 9999 and [_DID310S_] ! = 7777 and [_DID310S_] ! = 6666


-- 6666 means provider didn't specify goals. Thus, it is reasonable that if provider specify goals, it may 
-- conform to the mean value. So, I assign mean value to those 6666. 

update [hge].[DIQ] set [_DID310S_] = 123.06
where [_DID310S_] = '9999' and [_DID310S_] = '6666'

update [hge].[DIQ] set [_DID310S_] = NULL
where [_DID310S_] = '7777'


--DID310D
alter table [hge].[math] alter column [_DID310D_] float

select AVG ([_DID310D_]) from [hge].[math] 
where  [_DID310D_] ! = 9999 and [_DID310D_] ! = 7777 and [_DID310D_] ! = 6666

update [hge].[DIQ] set [_DID310D_] = 76.77
where [_DID310D_] = '9999' and [_DID310D_] = '6666'

update [hge].[DIQ] set [_DID310D_] = NULL
where [_DID310D_] = '7777'


--DID320
alter table [hge].[math] alter column [_DID320_] float

select AVG ([_DID320_]) from [hge].[math] 
where  [_DID320_] ! = 9999 and [_DID320_] ! = 7777 
and [_DID320_] ! = 6666 and [_DID320_] ! = 5555

update [hge].[DIQ] set [_DID320_] = 122.98
where [_DID320_] = '9999' and [_DID320_] = '6666'


-- Because 5555 means people who never heard of LDL, which means those people have the greatest
-- posibility that they never had cholesterol test. Thus, I assign Null to them. And 6666 means 
-- people who never had cholestorol as well. Thus, I assign Null to them as well. 
update [hge].[DIQ] set [_DID320_] = NULL
where [_DID320_] = '7777' and [_DID320_] = '6666' and [_DID320_] = '5555'


--DID330
alter table [hge].[math] alter column [_DID330_] float

select AVG ([_DID330_]) from [hge].[math] 
where  [_DID330_] ! = 9999 and [_DID330_] ! = 7777 and [_DID330_] ! = 6666

update [hge].[DIQ] set [_DID330_] = 116.16
where [_DID330_] = '9999' and [_DID330_] = '6666'

update [hge].[DIQ] set [_DID330_] = NULL
where [_DID330_] = '7777'


--DID341
alter table [hge].[math] alter column [_DID341_] float

select AVG ([_DID341_]) from [hge].[math] 
where  [_DID341_] ! = 9999 and [_DID341_] ! = 7777 

update [hge].[DIQ] set [_DID341_] = 2.4
where [_DID341_] = '9999' 

update [hge].[DIQ] set [_DID341_] = NULL
where [_DID341_] = '7777'


--DIQ350U

alter table [hge].[DIQ] alter column [_DIQ350U_] float
alter table [hge].[DIQ] alter column [_DID350_] float

update [hge].[DIQ] set [_DIQ350U_] = 365
where [_DIQ350U_] = 1

update [hge].[DIQ] set [_DIQ350U_] = 52.1
where [_DIQ350U_] = 2

update [hge].[DIQ] set [_DIQ350U_] = 12
where [_DIQ350U_] = 3

update [hge].[DIQ] set [_DIQ350U_] = 1
where [_DIQ350U_] = 4


update [hge].[DIQ] set [_DID350_] = [_DIQ350U_]*[_DID350_]


--DID350

select AVG ([_DID350_]) from [hge].[DIQ] 
where  [_DID350_] ! = 9999 and [_DID350_] ! = 7777 

update [hge].[DIQ] set [_DID350_] = 304.9
where [_DID350_] = '9999' 

update [hge].[DIQ] set [_DID350_] = NULL
where [_DID350_] = '7777'










--Change viraible names
EXEC sp_RENAME '[hge].[DIQ].[_SEQN_]' , ' sequence', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ010_]' , 'diabetes', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID040_]' , 'agedia', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ160_]' , 'prediabetes', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ170_]' , 'healthrisk', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ172_]' , 'feelrisk', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175A_]', 'familyhistory', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175B_]' , 'overweight', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175C_]' , 'age', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175D_]' , 'poordiet', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175E_]' , 'race', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175F_]' , 'babyover9lbs', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175G_]' , 'lackphysical', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175H_]' , 'HBP', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175I_]' , 'HBS', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175J_]' , 'HC', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175K_]' , 'Hypo', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175L_]' , 'hunger', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175M_]' , 'tingling', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175N_]' , 'blurred', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175O_]' , 'fatigue', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175P_]' , 'atrisk', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175Q_]' , 'Drwarning', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175R_]' , 'other', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175S_]' , 'Gesdia', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175T_]' , 'urination', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175U_]' , 'thirst', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175V_]' , 'sugar', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175W_]' , 'medication', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ175X_]' , 'POS', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ180_]' , 'bloodtest', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ050_]' , 'insulin', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID060_]' , 'insulintime', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ060U_]' , 'unitinsulin', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ070_]' , 'diapill', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ230_]' , 'diaspecial', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ240_]' , 'Drsee', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID250_]' , 'Drtime', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID260_]' , 'glucobloodtimes', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ260U_]' , 'unitgluco', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ275_]' , 'DrcheckA1C', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ280_]' , 'lastA1C', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ291_]' , 'DrsayA1C', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ300S_]' , 'SBP', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ300D_]' , 'DBP', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID310S_]' , 'DrSBP', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID310D_]' , 'DrDBP', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID320_]' , 'LDLnum', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID330_]' , 'DrLDL', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID341_]' , 'Drcheckfeet', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DID350_]' , 'Checkfeet', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ350U_]' , 'unitcheckfeet', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ360_]' , 'pupils', 'COLUMN'
EXEC sp_RENAME '[hge].[DIQ].[_DIQ080_]' , 'retinopathy', 'COLUMN'











